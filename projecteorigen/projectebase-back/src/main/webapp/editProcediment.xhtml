<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<!--
Pàgina per editar procediments
-->
<ui:composition template="/template/template.xhtml">

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam id="unitatOrganicaId" name="unitatOrganicaId" 
                         value="#{editProcediment.unitatOrganica.id}" 
                         required="#{not facesContext.postback}" /> 
            <f:viewParam name="id" value="#{editProcediment.procediment.id}"/>
            <!-- si la validació/conversió falla el viewAction no es processarà per això necessitam aquest event -->
            <f:event type="postValidate" listener="#{editProcediment.badRequestOnValidationFailed}" />
            <f:viewAction action="#{editProcediment.load}"/>
        </f:metadata>
    </ui:define>

    <ui:define name="pageTitle">
        <h:outputFormat value="#{editProcediment.create ? labels.newProcediment_title : labels.editProcediment_title}">
            <f:param value="#{editProcediment.unitatOrganica.nom}"/>
            <f:param value="#{editProcediment.unitatOrganica.codiDir3}"/>
        </h:outputFormat>
    </ui:define>

    <ui:define name="breadcrumb">
        <p:menuitem value="#{labels.listUnitatOrganica_link}" outcome="/listUnitatOrganica"/>
        <p:menuitem value="#{labels.listProcediment_link}" outcome="/listProcediment" includeViewParams="true"/>
        <p:menuitem value="#{editProcediment.create ? labels.newProcediment_link : labels.editProcediment_link}"
                    outcome="/editProcediment" includeViewParams="true"/>
    </ui:define>


    <ui:define name="content">

        <h:form id="form">

            <ui:decorate template="/template/field.xhtml">
                <ui:define name="label">
                    <p:outputLabel for="codiDir3" value="#{labels.procediment_codiSia}"/>
                </ui:define>
                <ui:define name="input">
                    <p:inputText id="codiDir3" value="#{editProcediment.procediment.codiSia}" 
                                 readonly="#{not editProcediment.create}"/>
                    <p:message for="codiDir3"/>
                </ui:define>
            </ui:decorate>

            <ui:decorate template="/template/field.xhtml">
                <ui:define name="label">
                    <p:outputLabel for="nom" value="#{labels.procediment_nom}"/>
                </ui:define>
                <ui:define name="input">
                    <p:inputText id="nom" value="#{editProcediment.procediment.nom}"/>
                    <p:message for="nom"/>
                </ui:define>
            </ui:decorate>

            <ui:decorate template="/template/buttons.xhtml">
                <ui:define name="buttons">
                    <p:commandButton id="saveOrUpdateButton" action="#{editProcediment.saveOrUpdate}"
                                     value="#{labels.button_guardar}"
                                     process="@form" update="@form"/>
                    <p:button value="#{labels.button_tornar}" outcome="/listProcediment" styleClass="float-right">
                        <f:param name="unitatOrganicaId" value="#{editProcediment.unitatOrganica.id}"/>
                    </p:button>
                </ui:define>
            </ui:decorate>

        </h:form>

    </ui:define>
</ui:composition>
</html>
